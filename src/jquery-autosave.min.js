jQuery.fn.autosave=function(a){function c(a){var c=/^data\-(\w+)$/,d={};return d.value=a.value||"",d.name=a.name||"",b.each(a.attributes,function(a,b){c.test(b.nodeName)&&(attribute_name=c.exec(b.nodeName)[1],d[attribute_name]=b.value)}),d}var b=jQuery;b.each(this,function(){var d=b(this),e={url:"",method:"POST",event:"change",data:{},type:"html",debug:!1,before:function(){},done:function(){},fail:function(){},always:function(){}};a=b.extend(e,a);var f=c(this),g=f.event||a.event;d.on(g,function(e){var f=b(this);a.before&&a.before.call(d);var g=c(this);a=b.extend(a,g);var h=b.extend(a.data,g);return a.debug=="false"&&(a.debug=!1),delete h.url,delete h.method,delete h.type,delete h.debug,h.event=a.event,a.debug?(console.log(h),e.preventDefault(),!1):(b.ajax({url:a.url,type:a.method,cache:!1,data:h,dataType:a.type}).done(function(){d.trigger("autosave-done")}).fail(function(){d.trigger("autosave-fail")}).always(function(){d.trigger("autosave-always")}),!0)}),a.done&&d.on("autosave-done",function(){a.done.call(d)}),a.fail&&d.on("autosave-fail",function(){a.fail.call(d)}),a.always&&d.on("autosave-always",function(){a.always.call(d)})})}
